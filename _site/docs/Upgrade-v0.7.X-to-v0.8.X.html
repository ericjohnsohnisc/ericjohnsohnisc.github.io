<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
    <title>ILGPU - A Modern GPU Compiler for .Net Programs</title>
    <meta content="" name="description">
    <meta content="" name="keywords">
  
    <!-- Favicons -->
    <link href="../assets/img/favicon.png" rel="icon">
    <link href="../assets/img/apple-touch-icon.png" rel="apple-touch-icon">
  
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Jost:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
  
    <!-- Vendor CSS Files -->
    <link href="../assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="../assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="../assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="../assets/vendor/remixicon/remixicon.css" rel="stylesheet">
    <link href="../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
     
    <script src="https://unpkg.com/boxicons@latest/dist/boxicons.js"></script>
  
    <!-- Template Main CSS File -->
    <link href="../assets/css/style.css" rel="stylesheet">

  <!-- Custom Styles CSS File -->
  <link href="../assets/css/custom-styles.css" rel="stylesheet">
    
  </head>

  <body class="wiki">
    <!-- ======= Header ======= -->
<header id="header" class="fixed-top ">
    <div class="container d-flex align-items-center">

      <a href="../index.html" class="logo me-auto"><img src="../assets/img/ilgpu-logo.svg" alt="" class="img-fluid"></a>

      <nav id="navbar" class="navbar">
        <ul>
          <li class="dropdown"><a>About</a>
          <ul>
            <li><a href="../index.html#learn-more" class="scrollto">Learn More</a></li>
            <li><a href="../index.html#highlights" class="scrollto">Highlights</a></li>
            <li><a href="../index.html#features">Features</a></li>
            <li><a href="../index.html#news" class="scrollto">News</a></li>
            <li><a href="../index.html#faq">FAQ</a></li>
          </ul>
          </li>
          <li class="dropdown"><a class="scrollto" href="../index.html#about">Project</a>
            <ul>
              <li><a href="https://github.com/m4rs-mt/ILGPU/" class="scrollto">Sourcecode</a></li>
              <li><a href="../index.html#features">Releases</a></li>
              <li><a href="../index.html#news" class="scrollto">Milestones</a></li>
            </ul>
            </li>
        <li><a href="/wiki/home">Documentation</a></li>
        <li><a href="https://discord.com/invite/X6RBCff" target="_blank">Discord</a></li>
        <li><a class="getstarted scrollto" href="../index.html#cta">Get Started</a></li>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav><!-- .navbar -->

    </div>
  </header><!-- End Header -->


    <section id="sidebar">
    <div id="sidebar-header">
        <h4>Documentation</h4>
        </div>
    <nav id="wiki-nav">
        <h5>Primers</h5>
        <ul>
            <li><a href="/docs/Readme.html">Home</a></li> 
            <li><a href="/docs/Primer_00.html">Setting Up ILGPU</a></li>
            <li><a href="/docs/Primer_01.html">A GPU Is Not A CPU</a></li>
            <li><a href="/docs/Primer_02.html">Memory & Bandwidth Threads</a></li>
        </ul>
        <h5>Beginner</h5>
        <ul>
            <li><a href="/docs/Tutorial_01.html">Context & Accelerators</a></li> 
            <li><a href="/docs/Tutorial_02.html">Setting Up ILGPU</a></li>
            <li><a href="/docs/Tutorial_03.html">A GPU Is Not A CPU</a></li>
            <li><a href="/docs/Tutorial_04.html">Memory & Bandwidth Threads</a></li>
        </ul>
        <h5>Advanced</h5>
        <ul>
            <li><a href="/docs/Accelerators-and-Streams.html">Accelerators & Streams</a></li> 
            <li><a href="/docs/Memory-Buffers-and-Views.html">Memory Buffers & Views</a></li> 
            <li><a href="/docs/Kernels.html">Kernels</a></li> 
            <li><a href="/docs/Shared-Memory.html">Shared Memory</a></li> 
            <li><a href="/docs/Math-Functions.html">Math Functions</a></li> 
            <li><a href="/docs/Dynamically-Specialized-Kernels.html">Dynamically Specialized Kernels</a></li> 
            <li><a href="/docs/Debugging-and-Profiling.html">Debugging & Profiling</a</li> 
            <li><a href="/docs/Inside-ILGPU.html">Inside ILGPU</a></li> 
        </ul>
        
        <h5>Upgrade Guides</h5>
        <ul>
            <li><a href="/docs/Upgrade-v0.8.X-to-v0.9.X.html">v0.8.X to v0.9.X</a></li> 
            <li><a href="/docs/Upgrade-v0.8.0-to-v0.8.1.html">v0.8.0 to v0.8.1</a></li> 
            <li><a href="/docs/Upgrade-v0.7.X-to-v0.8.X.html">v0.7.X to v0.8.X</a></li> 
            <li><a href="/docs/Upgrade-v0.6.X-to-v0.7.X.html">v0.6.X to v0.7.X</a></li> 
            <li><a href="/docs/Upgrade-v0.3.X-to-v0.5.X.html">v0.3.X to v0.5.X</a></li> 
            <li><a href="/docs/Upgrade-v0.1.X-to-v0.2.X.html">v0.1.X to v0.2.X</a></li> 
          </ul>
    </nav>

    <div class="box">
        <span dd-toggle="theme" class="df">
          <div id="toggle_theme" class="dd-theme__switcher">
            <span class="dd-theme__switcher-btn">
              <svg xmlns="http://www.w3.org/2000/svg" class="dd-icon icon-tabler icon-tabler-sun" width="24" height="24"
                viewBox="0 0 24 24" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path stroke="none" d="M0 0h24v24H0z" />
                <circle cx="12" cy="12" r="4" />
                <path d="M3 12h1M12 3v1M20 12h1M12 20v1M5.6 5.6l.7 .7M18.4 5.6l-.7 .7M17.7 17.7l.7 .7M6.3 17.7l-.7 .7" />
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" class="dd-icon icon-tabler icon-tabler-moon" width="24" height="24"
                viewBox="0 0 24 24" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path stroke="none" d="M0 0h24v24H0z" />
                <path d="M16.2 4a9.03 9.03 0 1 0 3.9 12a6.5 6.5 0 1 1 -3.9 -12" />
              </svg>
            </span>
          </div>
          &nbsp;<label class="box-lbl" for="toggle_theme"><strong>Toggle Light/Dark Theme</strong></label>
      </div>

</section>
    <section id="wiki-main">
      <h2 id="general-notes">General Notes</h2>

<p>All explicitly grouped kernel launchers have been updated.
This simplifies programming and feels more natural for most kernel developers familiar with Cuda and OpenCL.
New static <code class="language-plaintext highlighter-rouge">Group</code> and <code class="language-plaintext highlighter-rouge">Grid</code> properties provide convenient access to grid and group indices.</p>

<p>Dynamic partial evaluation allows to create specialized kernels that are <i>automagically compiled</i> for you.
Use the structure type <code class="language-plaintext highlighter-rouge">SpecializedValue&lt;T&gt;</code> on kernel parameters to enable specialization of values at runtime.
Note that these values must support the <code class="language-plaintext highlighter-rouge">IEquatable</code> interface for them to be cached correctly.
As soon as a value is found (which could not be found in the cache), the kernel is recompiled in the background with the new specialized value.</p>

<p>Note that the <code class="language-plaintext highlighter-rouge">ILGPU.Index</code> type is now considered obsolete because there is a name ambiguity between <code class="language-plaintext highlighter-rouge">ILGPU.Index</code> and <code class="language-plaintext highlighter-rouge">System.Index</code>.
Please update your code to use the new type <code class="language-plaintext highlighter-rouge">ILGPU.Index1</code> instead.
<em>Note further that these index types might be removed in the future.</em></p>

<h2 id="new-kernel-launchers">New Kernel Launchers</h2>

<p>In previous versions, it was necessary to have a kernel parameter of type <code class="language-plaintext highlighter-rouge">GroupedIndex</code> for explicitly grouped kernels.
Accesses to the current group and grid indices were only possible by accessing this parameter.
Alternative methods to access group and grid indices were introduced in v0.7.X, in order to create helper methods that can directly access those properties.
From a software-engineering point of view, this could have been considered the same functionality with two different flavors.
This <em>issue</em> was corrected in v0.8.
It also simplifies programming for Cuda and OpenCL developers.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="err">...</span>
<span class="err">{</span>
    <span class="nc">static</span> <span class="k">void</span> <span class="nf">OldKernel</span><span class="p">(</span><span class="n">GroupedIndex</span> <span class="n">index</span><span class="p">,</span> <span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kt">var</span> <span class="n">globalIndex</span> <span class="p">=</span> <span class="n">index</span><span class="p">.</span><span class="nf">ComputeGlobalIndex</span><span class="p">();</span>
      <span class="n">data</span><span class="p">[</span><span class="n">globalIndex</span><span class="p">]</span> <span class="p">=</span> <span class="m">42</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">static</span> <span class="k">void</span> <span class="nf">NewKernel</span><span class="p">(</span><span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kt">var</span> <span class="n">globalIndex</span> <span class="p">=</span> <span class="n">Grid</span><span class="p">.</span><span class="n">GlobalIndex</span><span class="p">.</span><span class="n">X</span><span class="p">;</span>
      <span class="c1">// or</span>
      <span class="kt">var</span> <span class="n">globalIndex</span> <span class="p">=</span> <span class="n">Group</span><span class="p">.</span><span class="n">IdxX</span> <span class="p">+</span> <span class="n">Grid</span><span class="p">.</span><span class="n">IdxX</span> <span class="p">*</span> <span class="n">Group</span><span class="p">.</span><span class="n">DimX</span><span class="p">;</span>

      <span class="n">data</span><span class="p">[</span><span class="n">globalIndex</span><span class="p">]</span> <span class="p">=</span> <span class="m">42</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">static</span> <span class="k">void</span> <span class="p">...(...)</span>
    <span class="p">{</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">context</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Context</span><span class="p">();</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">accl</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CudaAccelerator</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

        <span class="c1">// Old way</span>
        <span class="kt">var</span> <span class="n">oldKernel</span> <span class="p">=</span> <span class="n">accl</span><span class="p">.</span><span class="n">LoadStreamKernel</span><span class="p">&lt;</span><span class="n">GroupedIndex</span><span class="p">,</span> <span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;&gt;(</span><span class="n">OldKernel</span><span class="p">);</span>
        <span class="p">...</span>
        <span class="nf">oldKernel</span><span class="p">(</span><span class="k">new</span> <span class="nf">GroupedIndex</span><span class="p">(&lt;</span><span class="n">GridDim</span><span class="p">&gt;,</span> <span class="p">&lt;</span><span class="n">GroupDim</span><span class="p">&gt;),</span> <span class="n">buffer</span><span class="p">.</span><span class="n">View</span><span class="p">);</span>

        <span class="c1">// New way</span>
        <span class="kt">var</span> <span class="n">newKernel</span> <span class="p">=</span> <span class="n">accl</span><span class="p">.</span><span class="n">LoadStreamKernel</span><span class="p">&lt;</span><span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;&gt;(</span><span class="n">NewKernel</span><span class="p">);</span>
        <span class="p">...</span>
        <span class="nf">newKernel</span><span class="p">((&lt;</span><span class="n">GridDim</span><span class="p">&gt;,</span> <span class="p">&lt;</span><span class="n">GroupDim</span><span class="p">&gt;),</span> <span class="n">buffer</span><span class="p">.</span><span class="n">View</span><span class="p">);</span>
        <span class="c1">// Or</span>
        <span class="nf">newKernel</span><span class="p">(</span><span class="k">new</span> <span class="nf">KernelConfig</span><span class="p">(&lt;</span><span class="n">GridDim</span><span class="p">&gt;,</span> <span class="p">&lt;</span><span class="n">GroupDim</span><span class="p">&gt;),</span> <span class="n">buffer</span><span class="p">.</span><span class="n">View</span><span class="p">);</span>

        <span class="c1">// Or (using dynamic shared memory)</span>
        <span class="kt">var</span> <span class="n">sharedMemConfig</span>  <span class="p">=</span> <span class="n">SharedMemoryConfig</span><span class="p">.</span><span class="n">RequestDynamic</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(&lt;</span><span class="n">GroupDim</span><span class="p">&gt;);</span>
        <span class="nf">newKernel</span><span class="p">((&lt;</span><span class="n">GridDim</span><span class="p">&gt;,</span> <span class="p">&lt;</span><span class="n">GroupDim</span><span class="p">&gt;,</span> <span class="n">sharedMemConfig</span><span class="p">),</span> <span class="n">buffer</span><span class="p">.</span><span class="n">View</span><span class="p">);</span>

        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="dynamic-shared-memory">Dynamic Shared Memory</h2>

<p>Shared memory has long been supported by ILGPU.
However, it was limited to <em>statically known</em> allocations which have a known size at compile time of the kernel.
The new ILGPU version allows the use of dynamic shared memory, which can be specified for each kernel launch individually.</p>

<p>Note that this feature is only available with CPU and Cuda accelerators.
OpenCL users can use the <strong>Dynamic Specialization</strong> features to emulate this feature.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="err">...</span>
<span class="err">{</span>
    <span class="nc">static</span> <span class="k">void</span> <span class="nf">SharedMemKernel</span><span class="p">(</span><span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Use GetDynamic access dynamically specified shared memory</span>
        <span class="kt">var</span> <span class="n">dynamicMemory</span> <span class="p">=</span> <span class="n">SharedMemory</span><span class="p">.</span><span class="n">GetDynamic</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;&gt;();</span>

        <span class="p">...</span>

        <span class="c1">// Use GetDynamic with a different element type to access</span>
        <span class="c1">// the same memory region in a different way</span>
        <span class="kt">var</span> <span class="n">dynamicMemory2</span> <span class="p">=</span> <span class="n">SharedMemory</span><span class="p">.</span><span class="n">GetDynamic</span><span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;&gt;();</span>

        <span class="p">...</span>
    <span class="p">}</span>

    <span class="k">static</span> <span class="k">void</span> <span class="p">...(...)</span>
    <span class="p">{</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">context</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Context</span><span class="p">();</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">accl</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CudaAccelerator</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

        <span class="c1">// Create shared memory configuration using a custom element type.</span>
        <span class="c1">// Note that this does not need to be the same type that is used in the scope of the kernel.</span>
        <span class="c1">// Therefore, the following two configurations will allocate the same amount of shared memory:</span>
        <span class="kt">var</span> <span class="n">config</span> <span class="p">=</span> <span class="n">SharedMemoryConfig</span><span class="p">.</span><span class="n">RequestDynamic</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;(&lt;</span><span class="n">GroupSize</span><span class="p">&gt;</span> <span class="p">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">byte</span><span class="p">));</span>
        <span class="kt">var</span> <span class="n">config2</span> <span class="p">=</span> <span class="n">SharedMemoryConfig</span><span class="p">.</span><span class="n">RequestDynamic</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(&lt;</span><span class="n">GroupSize</span><span class="p">&gt;);</span>

        <span class="p">...</span>
        <span class="c1">// Pass the shared memory configuration to the kernel configuration</span>
        <span class="nf">kernel</span><span class="p">((&lt;</span><span class="n">GridDim</span><span class="p">&gt;,</span> <span class="p">&lt;</span><span class="n">GroupDim</span><span class="p">&gt;,</span> <span class="n">config</span><span class="p">),</span> <span class="n">buffer</span><span class="p">.</span><span class="n">View</span><span class="p">);</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="dynamic-specialization">Dynamic Specialization</h2>

<p>Dynamic specialization allows the definition of kernels that will be <em>specialized/optimized</em> during runtime.
This allows you to define kernels with <em>constant values</em> that are not known at compile time of the kernel or application.
Without knowing the exact values (or ranges of values) of certain parameters, the compiler’s optimization capabilities are limited, e.g. with regard to constant propagation and loop unrolling.</p>

<p>Similar functionality can be achieved by using generic types in a clever way.
However, dynamic specialization is much more convenient and easier to use.
Moreover, it is more flexible without leveraging the .Net reflection API to create specialized instances.</p>

<p>Please note that dynamically specialized kernels are precompiled during loading.
The final compilation step occurs during the first call of a new (non-cached) specialized parameter combination.
If a parameter combination was used previously, the corresponding specialized kernel instance is called.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="err">...</span>
<span class="err">{</span>
    <span class="nc">static</span> <span class="k">void</span> <span class="nf">GenericKernel</span><span class="p">(</span><span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">c</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">globalIndex</span> <span class="p">=</span> <span class="n">Grid</span><span class="p">.</span><span class="n">GlobalIndex</span><span class="p">.</span><span class="n">X</span><span class="p">;</span>
        <span class="c1">// Generates code that loads &lt;i&gt;c&lt;/i&gt; and adds the value &lt;i&gt;2&lt;/i&gt; at runtime of the kernel</span>
        <span class="n">data</span><span class="p">[</span><span class="n">globalIndex</span><span class="p">]</span> <span class="p">=</span> <span class="n">c</span> <span class="p">+</span> <span class="m">2</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">static</span> <span class="k">void</span> <span class="nf">SpecializedKernel</span><span class="p">(</span><span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">data</span><span class="p">,</span> <span class="n">SpecializedValue</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">c</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">globalIndex</span> <span class="p">=</span> <span class="n">Grid</span><span class="p">.</span><span class="n">GlobalIndex</span><span class="p">.</span><span class="n">X</span><span class="p">;</span>
        <span class="c1">// Generates code that has an inlined constant value</span>
        <span class="n">data</span><span class="p">[</span><span class="n">globalIndex</span><span class="p">]</span> <span class="p">=</span> <span class="n">c</span> <span class="p">+</span> <span class="m">2</span><span class="p">;</span> <span class="c1">// Will be specialized for every value &lt;i&gt;c&lt;/i&gt;</span>
    <span class="p">}</span>

    <span class="k">static</span> <span class="k">void</span> <span class="p">...(...)</span>
    <span class="p">{</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">context</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Context</span><span class="p">();</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">accl</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CudaAccelerator</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

        <span class="kt">var</span> <span class="n">genericKernel</span> <span class="p">=</span> <span class="n">accl</span><span class="p">.</span><span class="n">LoadStreamKernel</span><span class="p">&lt;</span><span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;,</span> <span class="kt">int</span><span class="p">&gt;(</span><span class="n">GenericKernel</span><span class="p">);</span>
        <span class="p">...</span>
        <span class="nf">genericKernel</span><span class="p">((&lt;</span><span class="n">GridDim</span><span class="p">&gt;,</span> <span class="p">&lt;</span><span class="n">GroupDim</span><span class="p">&gt;),</span> <span class="n">buffer</span><span class="p">.</span><span class="n">View</span><span class="p">,</span> <span class="m">40</span><span class="p">);</span>

        <span class="kt">var</span> <span class="n">specializedKernel</span> <span class="p">=</span> <span class="n">accl</span><span class="p">.</span><span class="n">LoadStreamKernel</span><span class="p">&lt;</span><span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;,</span> <span class="n">SpecializedValue</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;&gt;(</span><span class="n">GenericKernel</span><span class="p">);</span>
        <span class="p">...</span>
        <span class="nf">specializedKernel</span><span class="p">((&lt;</span><span class="n">GridDim</span><span class="p">&gt;,</span> <span class="p">&lt;</span><span class="n">GroupDim</span><span class="p">&gt;),</span> <span class="n">buffer</span><span class="p">.</span><span class="n">View</span><span class="p">,</span> <span class="n">SpecializedValue</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="m">40</span><span class="p">));</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="new-grid--group-properties">New Grid &amp; Group Properties</h2>

<p>The new version adds revised static <em>Grid</em> and <em>Group</em> properties.
The cumbersome <em>Index(X|Y|Z)</em> and <em>Dimension(X|Y|Z)</em> properties are now considered obsolete.
The new (much more convenient) properties <em>Idx(X|Y|Z)</em> and <em>Dim(X|Y|Z)</em> are available to replace the old ones.
Note that the <em>Index</em> and <em>Dimension</em> properties are still available to accessing all three dimensions of the dispatched <em>Grid</em>s and <em>Group</em>s.</p>

<p>Please update all uses in your programs, as the old properties will be removed in a future version.</p>

<div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="err">...</span>
<span class="err">{</span>
    <span class="nc">static</span> <span class="k">void</span> <span class="nf">GenericKernel</span><span class="p">(</span><span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">c</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">globalIndex</span> <span class="p">=</span> <span class="n">Grid</span><span class="p">.</span><span class="n">GlobalIndex</span><span class="p">.</span><span class="n">X</span><span class="p">;</span>
        <span class="c1">// Generates code that loads &lt;i&gt;c&lt;/i&gt; and adds the value &lt;i&gt;2&lt;/i&gt; at runtime of the kernel</span>
        <span class="n">data</span><span class="p">[</span><span class="n">globalIndex</span><span class="p">]</span> <span class="p">=</span> <span class="n">c</span> <span class="p">+</span> <span class="m">2</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">static</span> <span class="k">void</span> <span class="nf">SpecializedKernel</span><span class="p">(</span><span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">data</span><span class="p">,</span> <span class="n">SpecializedValue</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">c</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">globalIndex</span> <span class="p">=</span> <span class="n">Grid</span><span class="p">.</span><span class="n">GlobalIndex</span><span class="p">.</span><span class="n">X</span><span class="p">;</span>
        <span class="c1">// Generates code that has an inlined constant value</span>
        <span class="n">data</span><span class="p">[</span><span class="n">globalIndex</span><span class="p">]</span> <span class="p">=</span> <span class="n">c</span> <span class="p">+</span> <span class="m">2</span><span class="p">;</span> <span class="c1">// Will be specialized for every value &lt;i&gt;c&lt;/i&gt;</span>
    <span class="p">}</span>

    <span class="k">static</span> <span class="k">void</span> <span class="p">...(...)</span>
    <span class="p">{</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">context</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Context</span><span class="p">();</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">accl</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CudaAccelerator</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>

        <span class="kt">var</span> <span class="n">genericKernel</span> <span class="p">=</span> <span class="n">accl</span><span class="p">.</span><span class="n">LoadStreamKernel</span><span class="p">&lt;</span><span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;,</span> <span class="kt">int</span><span class="p">&gt;(</span><span class="n">GenericKernel</span><span class="p">);</span>
        <span class="p">...</span>
        <span class="nf">genericKernel</span><span class="p">((&lt;</span><span class="n">GridDim</span><span class="p">&gt;,</span> <span class="p">&lt;</span><span class="n">GroupDim</span><span class="p">&gt;),</span> <span class="n">buffer</span><span class="p">.</span><span class="n">View</span><span class="p">,</span> <span class="m">40</span><span class="p">);</span>

        <span class="kt">var</span> <span class="n">specializedKernel</span> <span class="p">=</span> <span class="n">accl</span><span class="p">.</span><span class="n">LoadStreamKernel</span><span class="p">&lt;</span><span class="n">ArrayView</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;,</span> <span class="n">SpecializedValue</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;&gt;(</span><span class="n">GenericKernel</span><span class="p">);</span>
        <span class="p">...</span>
        <span class="nf">specializedKernel</span><span class="p">((&lt;</span><span class="n">GridDim</span><span class="p">&gt;,</span> <span class="p">&lt;</span><span class="n">GroupDim</span><span class="p">&gt;),</span> <span class="n">buffer</span><span class="p">.</span><span class="n">View</span><span class="p">,</span> <span class="n">SpecializedValue</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="m">40</span><span class="p">));</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="unmanaged-type-constraints">Unmanaged Type Constraints</h2>

<p>The new version leverages the newly available <em>umanaged</em> structure type constraint in C# in favor of the <em>struct</em> generic type constraint on buffers, view and functions.
This ensures that a certain structure has the same representation in managed and unmanaged memory. This in turn allows ILGPU to generate faster code and simplifies the development process:
The compiler can immediately emit an error message at compile time when a type does not match this particular <em>unmanaged</em> type constraint.</p>

<p>In approx. 90% of all cases you do not need to do anything. However, if you use (or instantiate) generic types that should be considered <em>unmanaged</em>, you have to enable language version <em>8.0</em> of C#.
Please note that it is also safe to do for programs running on .Net 4.7 or .Net 4.8.</p>

      <div class="f5 contribution">
    <h2>Help us make these docs great!</h2>
    <p>All ILGPU docs are open source. See something that's wrong or unclear? Submit a pull request.</p>
        <a class="btn" href="https://github.com/m4rs-mt/ILGPU/edit/master/Docs/Upgrade-v0.7.X-to-v0.8.X.md" target="_blank" rel="noopener"><svg aria-hidden="true" role="img" class="octicon mr-1" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom;overflow:visible"><path fill-rule="evenodd" d="M7.177 3.073L9.573.677A.25.25 0 0110 .854v4.792a.25.25 0 01-.427.177L7.177 3.427a.25.25 0 010-.354zM3.75 2.5a.75.75 0 100 1.5.75.75 0 000-1.5zm-2.25.75a2.25 2.25 0 113 2.122v5.256a2.251 2.251 0 11-1.5 0V5.372A2.25 2.25 0 011.5 3.25zM11 2.5h-1V4h1a1 1 0 011 1v5.628a2.251 2.251 0 101.5 0V5A2.5 2.5 0 0011 2.5zm1 10.25a.75.75 0 111.5 0 .75.75 0 01-1.5 0zM3.75 12a.75.75 0 100 1.5.75.75 0 000-1.5z"></path></svg>Make a contribution</a>
        <p class="color-fg-muted f6 mt-2">Or,<!-- --> <a href="https://github.com/m4rs-mt/ILGPU#general-contribution-guidelines" target="_blank" rel="noopener">learn how to contribute.</a></p>
    </div>
    </section>
      <!-- ======= Footer ======= -->
  <footer id="footer">

  

    <div class="container footer-bottom clearfix text-center">
      <div class="">
        &copy; Copyright <script type="text/javascript">document.write(new Date().getFullYear());</script> <span>ILGPU</span>. All Rights Reserved.
      </div>
      <div class="credits">
      </div>
    </div>
  </footer><!-- End Footer -->

  <div id="preloader"></div>
  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="../assets/vendor/aos/aos.js"></script>
  <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="../assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="../assets/vendor/php-email-form/validate.js"></script>
  <script src="../assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="../assets/vendor/waypoints/noframework.waypoints.js"></script>

  <!-- Template Main JS File -->
  <script src="../assets/js/main.js"></script>

  <!-- Easter Egg JS -->
  <script type="text/javascript">
    function easteregg() {
    var span = document.getElementById('easter-egg');
      if (span.textContent == 'ö') {
        span.textContent = 'œ' ;
      }
      else if (span.textContent == 'œ') {
        span.textContent = 'ö' ;
      }
    }
    </script>
    <div>
      <script type="text/javascript">
        // Set the theme from localStorage(if exist) || or set default light
let theme = window.localStorage.getItem('theme') || 'light';
// Activate the current theme (using class)
body.classList = theme;
// Available Themes
let available_themes = document.querySelectorAll('[dd-theme]');

/** Light / Dark theme Toggle */
// Toggle Dark / Light theme
let _toggler = document.querySelector('[dd-toggle]');
_toggler.addEventListener('click', toggleTheme);
// Function: toggle theme(light & dark)
function toggleTheme() {
 // Toggle light / dark theme
 ( theme == 'light' ? theme = 'dark' : theme = 'light');
 // Apply class to body
 body.classList = theme;
 // Store theme var to localStorage
 window.localStorage.setItem('theme', theme );
}
      </script>
    </div>
  </body>
</html>