<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta charset="utf-8">

  <!-- Page Info -->
  <link rel="shortcut icon" href="/assets/img/Armada-favicon.png">
  <title>User – Armada Project</title>
  <meta name="description" content="">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title"
    content="User – Armada Project">
  <meta name="twitter:description" content="">
  <meta name="twitter:image:src" content="http://localhost:4000/assets/img/ill/bg_contactus3.svg">

  <!-- Facebook OpenGraph -->
  <meta property="og:title"
    content="User – Armada Project" />
  <meta property="og:description" content="" />
  <meta property="og:image" content="http://localhost:4000/assets/img/ill/bg_contactus3.svg" />

  <!--  Fonts and icons -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
  <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
  <!-- Nucleo Icons -->
  <link href="/assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="/assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- Font Awesome Icons -->
  <link href="/assets/css/font-awesome.css" rel="stylesheet" />
  <link href="/assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- CSS Files -->
  <link rel="stylesheet" href="/assets/styles/styles.css" rel="stylesheet">

  

  

</head>

<body>
  
<nav id="navbar-main" class="navbar navbar-main navbar-expand-lg navbar-transparent headroom">
  

        <div class="container">
          
          <a href="/" class="navbar-brand mr-lg-5">
            <img src="/assets/img/brand/Armada-white-rectangle.png">
          </a>
          

          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_global"
            aria-controls="navbar_global" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="navbar-collapse collapse" id="navbar_global">
            <div class="navbar-collapse-header">
              <div class="row">
                <div class="col-6 collapse-brand">
                  
                  <a href="/">
                    <img src="/assets/img/brand/Armada-white-rectangle.png">
                  </a>
                  
                </div>
                <div class="col-6 collapse-close">
                  <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar_global"
                    aria-controls="navbar_global" aria-expanded="false" aria-label="Toggle navigation">
                    <span></span>
                    <span></span>
                  </button>
                </div>
              </div>
            </div>
            <ul class="navbar-nav navbar-nav-hover align-items-lg-center ml-lg-auto">
              
                
                  <li class="nav-item">
                    <a href="/design" class="nav-link">
                      <span class="nav-link-inner--text">Design</span>
                    </a>
                  </li>
                
              
                
                  <li class="nav-item">
                    <a href="/development" class="nav-link">
                      <span class="nav-link-inner--text">Development</span>
                    </a>
                  </li>
                
              
                
                  <li class="nav-item dropdown">
                    <a href="javascript:;" class="nav-link" data-toggle="dropdown" role="button">
                      <span class="nav-link-inner--text">Documentation</span>
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                      
                      <a class="dropdown-item" href="/user">
                        <i class="ni "></i>
                        User Guide
                      </a>
                      
                      <a class="dropdown-item" href="/production">
                        <i class="ni "></i>
                        Production Install
                      </a>
                      
                      <a class="dropdown-item" href="/quickstart">
                        <i class="ni "></i>
                        Quickstart
                      </a>
                      
                    </div>
                  </li>
                
              
                
                  <li class="nav-item">
                    <a href="/contributing" class="nav-link">
                      <span class="nav-link-inner--text">Contribute</span>
                    </a>
                  </li>
                
              
              <li class="nav-item github-logo-header"><a class="" href="https://github.com/G-Research/armada">
                <img src="/assets/img/brand/GitHub-Mark-Light-120px-plus.png" width="40" height="40"></a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
  <div class="wrapper page">
    
    <!-- Is not a blog post or blog archive or contact page -->
    
    <!-- Is a page with a banner -->
    <div class="page-header page-header-small header-filter mb-4">
      <div class="page-header-image card-background"
        style="background-image: url(/assets/img/ill/bg_contactus3.svg);"></div>
      <div class="container contentWrapper">
        <div class="row">
          <div class="col-lg-10 mx-auto text-center pt-4">
            <h2 class="display-2 text-white">User</h2>
            <h2 class="lead text-white pl-5 pr-5 pb-3 text-center"></h2>
          </div>
        </div>
      </div>
    </div>
    
    

    <div id="main" class="container">
      <h1 id="user-guide">User Guide</h1>

<h2 id="how-to-use-armada">How to use Armada</h2>

<p>The main concepts to understand in Armada are:</p>
<ul>
  <li>Job</li>
  <li>Job Set</li>
  <li>Queue</li>
</ul>

<h3 id="job">Job</h3>

<p>A Job in Armada is equivalent to a Pod in Kubernetes, with a few extra metadata fields.</p>

<p>It is the most basic unit of work in Armada and if you are familiar with Kubernetes it will be very familiar to you.</p>

<p>A simple example of a job in yaml form looks like:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">queue</span><span class="pi">:</span> <span class="s">test</span>
<span class="na">priority</span><span class="pi">:</span> <span class="m">0</span>
<span class="na">jobSetId</span><span class="pi">:</span> <span class="s">set1</span>
<span class="na">podSpec</span><span class="pi">:</span>
  <span class="na">terminationGracePeriodSeconds</span><span class="pi">:</span> <span class="m">0</span>
  <span class="na">restartPolicy</span><span class="pi">:</span> <span class="s">Never</span>
  <span class="na">containers</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">sleep</span>
      <span class="na">imagePullPolicy</span><span class="pi">:</span> <span class="s">IfNotPresent</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">busybox:latest</span>
      <span class="na">args</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">sleep</span>
        <span class="pi">-</span> <span class="s">60s</span>
      <span class="na">resources</span><span class="pi">:</span>
        <span class="na">limits</span><span class="pi">:</span>
          <span class="na">memory</span><span class="pi">:</span> <span class="s">64Mi</span>
          <span class="na">cpu</span><span class="pi">:</span> <span class="s">150m</span>
        <span class="na">requests</span><span class="pi">:</span>
          <span class="na">memory</span><span class="pi">:</span> <span class="s">64Mi</span>
          <span class="na">cpu</span><span class="pi">:</span> <span class="s">150m</span>
</code></pre></div></div>
<p>A Job belongs to a Queue and a Job Set, seen by the corresponding fields. Finally it has a priority, which is a relative priority to other Jobs in the same queue; the lower the number, the higher the priority.</p>

<p>If you submit 2 Jobs, A and B, and you want B to be ordered before A in the queue, B should be given a priority lower than A using the priority field.</p>

<p>All jobs of priority 0 will be taken from the queue before any with priority 1 and time of submission is not taken into account.</p>

<p><strong>Note: Job resource request and limit should be equal. Armada does not support limit &gt; request currently.</strong></p>

<h3 id="job-set">Job Set</h3>

<p>A Job Set is a logical grouping of Jobs.</p>

<p>The reasons you may want to do this is because you can;</p>
<ul>
  <li>Watch all events of a Job Set together</li>
  <li>Cancel all jobs in a Job Set together</li>
</ul>

<p>The Job Sets are typically meant to be used to represent a single task, where many Jobs are involved.</p>

<p>You can then follow this Job Set as a single entity rather than having to track multiple associated Jobs.</p>

<p>A Job Set has no impact on the running of jobs a this moment and is purely an abstraction over a group of Jobs.</p>

<h3 id="queue">Queue</h3>

<p>A queue is the likely most important aspect of Armada.</p>

<p>Conceptually is it quite simple, it is just a Queue of jobs waiting to be run on a Kubernetes cluster.</p>

<p>In addition to being a queue, it is also used:</p>
<ul>
  <li>Maintaining fair share over time</li>
  <li>Security boundary (Not yet implemented) between jobs</li>
  <li>Resource limits</li>
</ul>

<h5 id="fair-share">Fair share</h5>

<p>Queues are provided with a fair share of the resource available on all clusters over time.</p>

<p>That is to say if there are 5 queues and they were all to submit infinite jobs (well in excess of cluster capacity), then each queue should receive the  same amount of compute resource over the course of time. No single queue should get a larger share of the available resource.</p>

<p>The reason we say over time, as at any single moment we cannot guarantee the queues will be exactly equal, however each job submitted has a cost. So if one queue gets a larger share early, they’ll receive a lesser share later to make up for it.</p>

<h5 id="priority-factor">Priority Factor</h5>

<p>A Queue has a Priority Factor.</p>

<p>The lower the number, the greater the share that queue will receive.</p>

<p>So if you have 2 Queues:</p>
<ul>
  <li>A - Priority 10</li>
  <li>B - Priority 1</li>
</ul>

<p>We would expect B to receive substantially more resource on the clusters than A over time.</p>

<p>All priorities are relative, so you can make your own scheme of priority numbers. So for example you could have “normal” be 100, “high” be 50 and “max” be 10.</p>

<p>Priority allows great flexibility, as it means you can predictably give certain queues a bigger share of resource than others.</p>

<h5 id="security-boundary">Security Boundary</h5>

<p>Armada allows to set user (and group) permissions for a specific Queue using owners (and groupOwners) options.</p>

<p>The job set events are available to all users with “watch_all_events” permissions.</p>

<p>If <code class="language-plaintext highlighter-rouge">kubernetes.impersonateUsers</code> is turned on, Armada will create pods in kubernetes impersonating owner of the job. This will enforce Kubernetes permissions and limit access to namespaces.</p>

<h5 id="resource-limits">Resource Limits</h5>

<p>Queues can also have a resource limit which is particularly useful if your installation has irregular usage, with busy and quiet periods.</p>

<p>It will prevent a user submitting lots of long running jobs in a quiet period and holding all the resource in your entire installation.</p>

<p>The limit will restrict them to a given percentage of all available resource over all clusters.</p>

<p>Using armadactl it’ll look like:
<code class="language-plaintext highlighter-rouge">armadactl create queue test --resourceLimits cpu=0.3,memory=0.2</code></p>

<p>Which means the queue at maximum can only ever be using 30% of the total cpu and 20% of the memory available over all clusters.</p>

<h4 id="considerations-when-setting-up-queues">Considerations when setting up Queues</h4>

<p>So now you know what Queues are and what they can do. We’ll briefly cover what to consider when setting them up.</p>

<p>You should consider how your organisation should be split up so users’ work is provided with an appropriate amount of resource allocation.</p>

<p>There are many ways this could be done, here are some ideas:</p>

<ul>
  <li>By user. All users will be equal (or scaled) relative to each other</li>
  <li>By team. All teams will be equal (or scaled) relative to each other</li>
  <li>By project. All projects will be equal (or scaled) relative to each other</li>
  <li>A mixture of all the above. So a given user may have their own queue, be part of a team queue and part of multiple project queues. They would then submit the appropriate jobs to the appropriate queues and expect them to all be given a fair amount of resource.
    <ul>
      <li>This allows a lot of flexibility in how you slice up your organisation, and combined with differing priorities it is possible to achieve any mix of resource allocation you want.</li>
    </ul>
  </li>
</ul>

<p>For each of the above, if you went for “By user”. Simply make each user of the system their own Queue and tell them to submit to it.</p>

<p>They will then receive the same amount of resource as any other user in the system.</p>

    </div>
  </div>


  <footer class="footer mt-5 pt-4">
  <div class="container">
    <div class="row row-grid align-items-center mb-2 mt-2">
      <div class="col-lg-6">
        <h4 class="mb-0 font-weight-light">Armada Project</h4>
      </div>
      <div class="col-lg-6 text-lg-right">
        
    

    
    <button onclick="location.href='https://twitter.com/GRESEARCHjobs';" rel="nofollow" class="btn btn-icon-only btn-twitter rounded-circle" data-toggle="tooltip" data-original-title="Twitter">
        <span class="btn-inner--icon">
            <i class="fab fa-twitter" aria-hidden="true"></i>
        </span>
    </button>
    

    

    

    

    

    
    <button onclick="location.href='https://gitter.im/ArmadaProject/community';" rel="nofollow" class="btn btn-icon-only btn-gitter rounded-circle" data-toggle="tooltip" data-original-title="Gitter">
        <span class="btn-inner--icon">
            <i class="fab fa-gitter" aria-hidden="true"></i>
        </span>
    </button>
    

    

    

    
    <button onclick="location.href='https://github.com/G-Research/armada';" rel="nofollow" class="btn btn-icon-only btn-github rounded-circle" data-toggle="tooltip" data-original-title="Github">
        <span class="btn-inner--icon">
            <i class="fab fa-github" aria-hidden="true"></i>
        </span>
    </button>
    

    

    

      </div>
    </div>
    <hr>
    <div class="row align-items-center justify-content-md-between">
      <div class="col-md-6">
        <div class="copyright">
          <span> © 2020 Armada Project</span>
        </div>
      </div>
      <div class="col-md-6">
        <ul class="nav nav-footer justify-content-end">
          
          
          <li class="nav-item">
            <a href="/design" class="nav-link">
              <span class="nav-link-inner--text">Design</span>
            </a>
          </li>
          
          
          
          <li class="nav-item">
            <a href="/development" class="nav-link">
              <span class="nav-link-inner--text">Development</span>
            </a>
          </li>
          
          
          
          <li class="nav-item">
            <a href="" class="nav-link">
              <span class="nav-link-inner--text">Documentation</span>
            </a>
          </li>

          
          
          
          <li class="nav-item">
            <a href="/contributing" class="nav-link">
              <span class="nav-link-inner--text">Contribute</span>
            </a>
          </li>
          
          
        </ul>
      </div>
    </div>
  </div>
</footer>



<!--   Core JS Files   -->
<script src="/assets/js/core/jquery.min.js" type="text/javascript"></script>
<script src="/assets/js/core/popper.min.js" type="text/javascript"></script>
<script src="/assets/js/core/bootstrap.min.js" type="text/javascript"></script>
<script src="/assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
<!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
<script src="/assets/js/plugins/bootstrap-switch.js"></script>
<!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
<script src="/assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
<!--  Plugin for the Carousel, full documentation here: http://jedrzejchalubek.com/ -->
<script src="/assets/js/plugins/glide.js" type="text/javascript"></script>
<!--  Plugin for the DatePicker, full documentation here: https://flatpickr.js.org/ -->
<script src="/assets/js/plugins/moment.min.js"></script>
<!--	Plugin for Select, full documentation here: https://joshuajohnson.co.uk/Choices/ -->
<script src="/assets/js/plugins/choices.min.js" type="text/javascript"></script>
<!--  Plugin for the DateTimePicker, full documentation here: https://flatpickr.js.org/ -->
<script src="/assets/js/plugins/datetimepicker.js" type="text/javascript"></script>
<!-- Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
<script src="/assets/js/plugins/jasny-bootstrap.min.js"></script>
<!-- Plugin for Headrom, full documentation here: https://wicky.nillia.ms/headroom.js/ -->
<script src="/assets/js/plugins/headroom.min.js"></script>
<!-- Control Center for Argon UI Kit: parallax effects, scripts for the example pages etc -->

<script>
  // Blog Post Carousel
  if (document.querySelector('.blogGlide') !== null) {
    new Glide('.blogGlide', {
      type: 'carousel',
      startAt: 0,
      focusAt: 2,
      perTouch: 1,
      perView: 4
    }).mount();
  }

  if (document.querySelector('.glide') !== null) {
    // Generic
     new Glide('.glide', {
      type: 'carousel',
      startAt: 0,
      focusAt: 2,
      perTouch: 1,
      perView: 4
    }).mount();
  }

  if (document.querySelector('.testimonial-glide') !== null) {
    // Testimonial Carousel
    new Glide('.testimonial-glide', {
      type: 'carousel',
      startAt: 0,
      focusAt: 2,
      perTouch: 1,
      perView: 4
    }).mount();
  }

</script>

<script>
  $(function () {
    var navOffset = $('#navbar-main').height();
    $('.contentWrapper').css('padding-top', navOffset * 2 + 'px');
  });    
</script>



<script src="/assets/js/argon-design-system.min.js?v=1.0.0" type="text/javascript"></script>

  

</body>

</html>
</body>

</html>